var t={d:function(e,n){for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},o:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}},e={};t.d(e,{Z:function(){return E}});var n="object"==typeof global&&global&&global.Object===Object&&global,o="object"==typeof self&&self&&self.Object===Object&&self,i=(n||o||Function("return this")()).Symbol,r=Object.prototype,s=r.hasOwnProperty,a=r.toString,c=i?i.toStringTag:void 0,u=Object.prototype.toString,h=i?i.toStringTag:void 0,l=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":h&&h in Object(t)?function(t){var e=s.call(t,c),n=t[c];try{t[c]=void 0;var o=!0}catch(t){}var i=a.call(t);return o&&(e?t[c]=n:delete t[c]),i}(t):function(t){return u.call(t)}(t)},p=function(t){if(!function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}(t))return!1;var e=l(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e};function d(t){return function(t){if(Array.isArray(t))return f(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function m(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function b(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var g=function(){function t(e,n){var o,i,r,s,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;m(this,t),b(this,"ctx",void 0),b(this,"component",void 0),b(this,"props",void 0),b(this,"options",void 0),b(this,"container",void 0),b(this,"sizes",void 0),b(this,"scene",void 0),b(this,"camera",void 0),b(this,"renderer",void 0),b(this,"canvas",void 0),b(this,"renderFunc",void 0),b(this,"resizeFunc",void 0),b(this,"status",void 0),this.ctx=e,this.props=a||{},this.component=n,this.checkComponent(),this.options={autoTick:null===(o=null===(i=this.component.options)||void 0===i?void 0:i.autoTick)||void 0===o||o,useDefaultTick:null===(r=null===(s=this.component.options)||void 0===s?void 0:s.useDefaultTick)||void 0===r||r},this.updateOwnFields(),this.unpackComponent()}var e,n;return e=t,n=[{key:"updateOwnFields",value:function(){Object.assign(this,{container:null,scene:null,camera:null,renderer:null,canvas:null,renderFunc:null,resizeFunc:null,sizes:{width:0,height:0},status:{isFirstStart:!1,isActive:!1,isRunning:!1}})}},{key:"unpackComponent",value:function(){var e=this;Object.keys(this.component).forEach((function(n){t.EXCLUDE_FIELDS.includes(n)||(t.COMPLEX_FIELDS.includes(n)?Object.assign(e,e.component[n]):e[n]=e.component[n])}))}},{key:"checkComponent",value:function(){var e=this;t.REQUIRED_FIELDS.forEach((function(t){if(void 0===e.component[t.name])throw new Error("".concat(t.name," is required for Threex component"));if("function"===t.type&&!p(e.component[t.name]))throw new Error("".concat(t.name," is not a function"));if("any"!==t.type&&v(e.component[t.name])!==t.type)throw new Error("".concat(t.name," is not a ").concat(t.type))}))}},{key:"useComponentHook",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=this[t];n&&p(n)&&(e.length?n.bind(this).apply(void 0,d(e)):n.bind(this)())}},{key:"resetComponentData",value:function(){var t=this;this.component.data&&Object.keys(this.component.data).forEach((function(e){t[e]=t.component.data[e]}))}},{key:"updateSizes",value:function(){this.sizes.width=this.container.offsetWidth,this.sizes.height=this.container.offsetHeight,this.sizes.aspectRatio=this.sizes.width/this.sizes.height}},{key:"$setup",value:function(t){if(!t)throw new Error("Container is not defined");this.container=t,this.updateSizes(),this.useComponentHook("setup"),this.canvas=this.renderer.domElement,this.container.appendChild(this.canvas),this.$resize(),this.resizeFunc=this.$resize.bind(this),window.addEventListener("resize",this.resizeFunc),this.status.isActive=!0}},{key:"$resize",value:function(){this.updateSizes(),this.useComponentHook("beforeResize"),this.camera.aspect&&(this.camera.aspect=this.sizes.aspectRatio),this.renderer.setSize(this.sizes.width,this.sizes.height),this.camera.updateProjectionMatrix(),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),this.useComponentHook("resized"),this.$render()}},{key:"$render",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o={time:t,delta:e,frame:n};this.useComponentHook("beforeRender",[o]),this.options.useDefaultTick&&this.renderer.render(this.scene,this.camera),this.useComponentHook("rendered",[o]),!this.ctx.gsap&&this.status.isRunning&&this.renderFunc&&window.requestAnimationFrame(this.renderFunc)}},{key:"$start",value:function(){this.useComponentHook("beforeStart"),this.status.isFirstStart=!1,this.options.autoTick&&(this.status.isRunning=!0,this.renderFunc=this.$render.bind(this),this.ctx.gsap?this.ctx.gsap.ticker.add(this.renderFunc):this.$render()),this.useComponentHook("started")}},{key:"$freeze",value:function(){this.useComponentHook("beforeFreeze"),this.options.autoTick&&this.ctx.gsap&&this.ctx.gsap.ticker.remove(this.renderFunc),this.status.isRunning=!1,this.useComponentHook("frozen")}},{key:"$destroy",value:function(){this.useComponentHook("beforeDestroy"),this.$freeze(),window.removeEventListener("resize",this.resizeFunc),this.container.removeChild(this.renderer.domElement),this.status.isActive=!1,this.updateOwnFields(),this.resetComponentData(),this.useComponentHook("destroyed")}}],n&&y(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();b(g,"COMPLEX_FIELDS",["data","methods"]),b(g,"EXCLUDE_FIELDS",["options"]),b(g,"REQUIRED_FIELDS",[{name:"setup",type:"function"}]);var k=g;function w(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function j(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var E=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),j(this,"ctx",void 0),j(this,"components",void 0),j(this,"props",void 0),this.props=e,this.components={},this.ctx={components:this.components,gsap:e.gsap},this.init()}var e,n;return e=t,(n=[{key:"init",value:function(){var t=this;Object.keys(this.props.components).forEach((function(e){var n=t.props.components[e];t.components[e]="module"in n?new k(t.ctx,n.module,n.props||null):new k(t.ctx,n),t[e]=t.components[e]}))}}])&&w(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),z=e.Z;export{z as default};