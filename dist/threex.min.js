!function(){"use strict";var t="object"==typeof global&&global&&global.Object===Object&&global,e="object"==typeof self&&self&&self.Object===Object&&self,n=(t||e||Function("return this")()).Symbol,i=Object.prototype,o=i.hasOwnProperty,s=i.toString,r=n?n.toStringTag:void 0,a=Object.prototype.toString,c=n?n.toStringTag:void 0,u=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":c&&c in Object(t)?function(t){var e=o.call(t,r),n=t[r];try{t[r]=void 0;var i=!0}catch(t){}var a=s.call(t);return i&&(e?t[r]=n:delete t[r]),a}(t):function(t){return a.call(t)}(t)},h=function(t){if(!function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}(t))return!1;var e=u(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e};function l(t){return function(t){if(Array.isArray(t))return d(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return d(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function m(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var y=function(){function t(e,n){var i,o,s,r,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;f(this,t),m(this,"ctx",void 0),m(this,"component",void 0),m(this,"props",void 0),m(this,"options",void 0),m(this,"container",void 0),m(this,"sizes",void 0),m(this,"scene",void 0),m(this,"camera",void 0),m(this,"renderer",void 0),m(this,"canvas",void 0),m(this,"renderFunc",void 0),m(this,"resizeFunc",void 0),m(this,"status",void 0),this.ctx=e,this.props=a||{},this.component=n,this.checkComponent(),this.options={autoTick:null===(i=null===(o=this.component.options)||void 0===o?void 0:o.autoTick)||void 0===i||i,useDefaultTick:null===(s=null===(r=this.component.options)||void 0===r?void 0:r.useDefaultTick)||void 0===s||s},this.updateOwnFields(),this.unpackComponent()}var e,n;return e=t,n=[{key:"updateOwnFields",value:function(){Object.assign(this,{container:null,scene:null,camera:null,renderer:null,canvas:null,renderFunc:null,resizeFunc:null,sizes:{width:0,height:0},status:{isFirstStart:!1,isActive:!1,isRunning:!1}})}},{key:"unpackComponent",value:function(){var e=this;Object.keys(this.component).forEach((function(n){t.EXCLUDE_FIELDS.includes(n)||(t.COMPLEX_FIELDS.includes(n)?Object.assign(e,e.component[n]):e[n]=e.component[n])}))}},{key:"checkComponent",value:function(){var e=this;t.REQUIRED_FIELDS.forEach((function(t){if(void 0===e.component[t.name])throw new Error("".concat(t.name," is required for Threex component"));if("function"===t.type&&!h(e.component[t.name]))throw new Error("".concat(t.name," is not a function"));if("any"!==t.type&&p(e.component[t.name])!==t.type)throw new Error("".concat(t.name," is not a ").concat(t.type))}))}},{key:"useComponentHook",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=this[t];n&&h(n)&&(e.length?n.bind(this).apply(void 0,l(e)):n.bind(this)())}},{key:"resetComponentData",value:function(){var t=this;this.component.data&&Object.keys(this.component.data).forEach((function(e){t[e]=t.component.data[e]}))}},{key:"updateSizes",value:function(){this.sizes.width=this.container.offsetWidth,this.sizes.height=this.container.offsetHeight,this.sizes.aspectRatio=this.sizes.width/this.sizes.height}},{key:"$setup",value:function(t){if(!t)throw new Error("Container is not defined");this.container=t,this.updateSizes(),this.useComponentHook("setup"),this.canvas=this.renderer.domElement,this.container.appendChild(this.canvas),this.$resize(),this.resizeFunc=this.$resize.bind(this),window.addEventListener("resize",this.resizeFunc),this.status.isActive=!0}},{key:"$resize",value:function(){this.updateSizes(),this.useComponentHook("beforeResize"),this.camera.aspect&&(this.camera.aspect=this.sizes.aspectRatio),this.renderer.setSize(this.sizes.width,this.sizes.height),this.camera.updateProjectionMatrix(),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),this.useComponentHook("resized"),this.$render()}},{key:"$render",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,i={time:t,delta:e,frame:n};this.useComponentHook("beforeRender",[i]),this.options.useDefaultTick&&this.renderer.render(this.scene,this.camera),this.useComponentHook("rendered",[i]),!this.ctx.gsap&&this.status.isRunning&&this.renderFunc&&window.requestAnimationFrame(this.renderFunc)}},{key:"$start",value:function(){this.useComponentHook("beforeStart"),this.status.isFirstStart=!1,this.options.autoTick&&(this.status.isRunning=!0,this.renderFunc=this.$render.bind(this),this.ctx.gsap?this.ctx.gsap.ticker.add(this.renderFunc):this.$render()),this.useComponentHook("started")}},{key:"$freeze",value:function(){this.useComponentHook("beforeFreeze"),this.options.autoTick&&this.ctx.gsap&&this.ctx.gsap.ticker.remove(this.renderFunc),this.status.isRunning=!1,this.useComponentHook("frozen")}},{key:"$destroy",value:function(){this.useComponentHook("beforeDestroy"),this.$freeze(),window.removeEventListener("resize",this.resizeFunc),this.container.removeChild(this.renderer.domElement),this.status.isActive=!1,this.updateOwnFields(),this.resetComponentData(),this.useComponentHook("destroyed")}}],n&&v(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();m(y,"COMPLEX_FIELDS",["data","methods"]),m(y,"EXCLUDE_FIELDS",["options"]),m(y,"REQUIRED_FIELDS",[{name:"setup",type:"function"}])}();