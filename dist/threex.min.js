var e={d:function(t,n){for(var i in n)e.o(n,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:n[i]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},t={};function n(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}e.d(t,{Z:function(){return d}});var c=function(){function e(t,n){var i,o,r,c,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;s(this,e),a(this,"ctx",void 0),a(this,"component",void 0),a(this,"props",void 0),a(this,"options",void 0),a(this,"container",void 0),a(this,"sizes",void 0),a(this,"scene",void 0),a(this,"camera",void 0),a(this,"renderer",void 0),a(this,"canvas",void 0),a(this,"renderFunc",void 0),a(this,"resizeFunc",void 0),a(this,"status",void 0),this.ctx=t,this.props=u||{},this.component=n,this.checkComponent(),this.options={autoTick:null===(i=null===(o=this.component.options)||void 0===o?void 0:o.autoTick)||void 0===i||i,useDefaultTick:null===(r=null===(c=this.component.options)||void 0===c?void 0:c.useDefaultTick)||void 0===r||r},this.updateOwnFields(),this.unpackComponent()}var t,i;return t=e,i=[{key:"updateOwnFields",value:function(){Object.assign(this,{container:null,scene:null,camera:null,renderer:null,canvas:null,renderFunc:null,resizeFunc:null,sizes:{width:0,height:0},status:{isFirstStart:!1,isActive:!1,isRunning:!1}})}},{key:"unpackComponent",value:function(){var t=this;Object.keys(this.component).forEach((function(n){e.EXCLUDE_FIELDS.includes(n)||(e.COMPLEX_FIELDS.includes(n)?Object.assign(t,t.component[n]):t[n]=t.component[n])}))}},{key:"checkComponent",value:function(){var t=this;e.REQUIRED_FIELDS.forEach((function(e){if(void 0===t.component[e.name])throw new Error("".concat(e.name," is required for Threex component"));if("any"!==e.type&&o(t.component[e.name])!==e.type)throw new Error("".concat(e.name," is not a ").concat(e.type))}))}},{key:"useComponentHook",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=this[e];i&&"function"==typeof i&&(t.length?i.bind(this).apply(void 0,n(t)):i.bind(this)())}},{key:"resetComponentData",value:function(){var e=this;this.component.data&&Object.keys(this.component.data).forEach((function(t){e[t]=e.component.data[t]}))}},{key:"updateSizes",value:function(){this.sizes.width=this.container.offsetWidth,this.sizes.height=this.container.offsetHeight,this.sizes.aspectRatio=this.sizes.width/this.sizes.height}},{key:"$setup",value:function(e){if(!e)throw new Error("Container is not defined");this.container=e,this.updateSizes(),this.useComponentHook("setup"),this.canvas=this.renderer.domElement,this.container.appendChild(this.canvas),this.$resize(),this.resizeFunc=this.$resize.bind(this),window.addEventListener("resize",this.resizeFunc),this.status.isActive=!0}},{key:"$resize",value:function(){this.updateSizes(),this.useComponentHook("beforeResize"),this.camera.aspect&&(this.camera.aspect=this.sizes.aspectRatio),this.renderer.setSize(this.sizes.width,this.sizes.height),this.camera.updateProjectionMatrix(),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),this.useComponentHook("resized"),this.$render()}},{key:"$render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,i={time:e,delta:t,frame:n};this.useComponentHook("beforeRender",[i]),this.options.useDefaultTick&&this.renderer.render(this.scene,this.camera),this.useComponentHook("rendered",[i]),!this.ctx.gsap&&this.status.isRunning&&this.renderFunc&&window.requestAnimationFrame(this.renderFunc)}},{key:"$start",value:function(){this.useComponentHook("beforeStart"),this.status.isFirstStart=!1,this.options.autoTick&&(this.status.isRunning=!0,this.renderFunc=this.$render.bind(this),this.ctx.gsap?this.ctx.gsap.ticker.add(this.renderFunc):this.$render()),this.useComponentHook("started")}},{key:"$freeze",value:function(){this.useComponentHook("beforeFreeze"),this.options.autoTick&&this.ctx.gsap&&this.ctx.gsap.ticker.remove(this.renderFunc),this.status.isRunning=!1,this.useComponentHook("frozen")}},{key:"$destroy",value:function(){this.useComponentHook("beforeDestroy"),this.$freeze(),window.removeEventListener("resize",this.resizeFunc),this.container.removeChild(this.renderer.domElement),this.status.isActive=!1,this.updateOwnFields(),this.resetComponentData(),this.useComponentHook("destroyed")}}],i&&r(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();a(c,"COMPLEX_FIELDS",["data","methods"]),a(c,"EXCLUDE_FIELDS",["options"]),a(c,"REQUIRED_FIELDS",[{name:"setup",type:"function"}]);var u=c;function h(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),p(this,"ctx",void 0),p(this,"components",void 0),p(this,"props",void 0),this.props=t,this.components={},this.ctx={components:this.components,gsap:t.gsap},this.init()}var t,n;return t=e,(n=[{key:"init",value:function(){var e=this;Object.keys(this.props.components).forEach((function(t){var n=e.props.components[t];e.components[t]="module"in n?new u(e.ctx,n.module,n.props||null):new u(e.ctx,n),e[t]=e.components[t]}))}}])&&h(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),l=t.Z;export{l as default};